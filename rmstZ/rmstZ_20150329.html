<!DOCTYPE html><html><head><meta http-equiv="Content-Type"content="text/html;charset=utf-8"/><style type="text/css">#divRoot{text-align:center;}#divTitle{clear:both;text-align:center;margin:16px;}#divOperateImd{text-align:center;margin:3px;display:none;}#divSave{text-align:center;margin:3px;display:none;}#divResult{margin:16px;}#divCopyright{clear:both;text-align:center;margin:16px;}</style></head><body><div id="divRoot"><div id="divTitle">rmstZ</div><div id="divFileReader"><input type="file"accept=".bin,.xml,.zip,.mde,.imd,.jpg,.mp3,"onchange="ReadFile(event)"/></div><div id="divOperate"><div id="divOperateImd"><select id="selectModeImd"onchange="SelectChanged()"><option value="txt">txt</option><option value="png"selected="selected">png</option></select><div id="divOptionImd"><input type="checkbox"id="inputDrawBackground"checked="checked"onchange="CheckChanged()">背景色</input><input type="checkbox"id="inputDrawTrack"checked="checked"onchange="CheckChanged()">轨道线</input><input type="checkbox"id="inputDrawFrame"checked="checked"onchange="CheckChanged()">边框线</input></div><div id="divOptionImd2"><input type="checkbox"id="inputDrawBeat"checked="checked"onchange="CheckChanged()">节拍线</input><input type="checkbox"id="inputDrawCombo"checked="checked"onchange="CheckChanged()">连击数</input><input type="checkbox"id="inputDrawDetermine"checked="checked"onchange="CheckChanged()">判定线</input></div></div></div><div id="divSave"><a id="aSave">保存</a></div><div id="divResult"></div><div id="divCopyright">Copyright © 心のsky Group</div></div><script type="text/javascript">var LittleEndian=(function(){var b=new ArrayBuffer(2);new DataView(b).setInt16(0,256,true);return new Int16Array(b)[0]===256;})();var SupportFileAPI=(function(){return!(typeof(window.File&&window.FileReader&&window.FileList&&window.Blob)==="undefined");})();var SupportCanvasAPI=(function(){return!(typeof document.createElement('canvas').getContext==="undefined");})();var SupportAudioAPI=(function(){return!(typeof(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContex)==="undefined");})();var IsUCBrowser=(function(){return(navigator.userAgent.indexOf("UCBrowser")!=-1);})();function GetFileName(n){var i=n.lastIndexOf(".");if(i!=-1){return n.substring(0,i);}
else{return"";}}
function GetExtension(n){var i=n.lastIndexOf(".");if(i!=-1){return n.substring(i+1);}
else{return"";}}
function OptimizeName(n){var f=GetFileName(n);var e=GetExtension(n);var i=f.indexOf("(");if(i!=-1){f=f.substring(0,i).trim();}
return f+"."+e;}
function GetDateTime(){var d=new Date();return FillString(d.getFullYear().toString(),"0",4,true)+"."+FillString((d.getMonth()+1).toString(),"0",2,true)+"."+FillString(d.getDate().toString(),"0",2,true)+" "+FillString(d.getHours().toString(),"0",2,true)+":"+FillString(d.getMinutes().toString(),"0",2,true)+":"+FillString(d.getSeconds().toString(),"0",2,true);}
function GetMD5(t){var SetArray=function(t){var c;var p;var l=t.length;var n=(((l+8)-((l+8)%64))/64+1)*16;var r=new Int32Array(n-1);var i=0;while(i<l){c=(i-(i%4))/4;p=(i%4)*8;r[c]=(r[c]|(t[i]<<p));i++;}
c=(i-(i%4))/4;p=(i%4)*8;r[c]=r[c]|(0x80<<p);r[n-2]=l<<3;r[n-1]=l>>>29;return r;};var Add=function(X,Y){var r=(X&0x3FFFFFFF)+(Y&0x3FFFFFFF);var X4=(X&0x40000000);var Y4=(Y&0x40000000);var X8=(X&0x80000000);var Y8=(Y&0x80000000);if(X4&Y4){return(r^0x80000000^X8^Y8);}
if(X4|Y4){if(r&0x40000000){return(r^0xC0000000^X8^Y8);}else{return(r^0x40000000^X8^Y8);}}else{return(r^X8^Y8);}};var Rotate=function(t,b){return(t<<b)|(t>>>(32-b));};var F=function(X,Y,Z){return(X&Y)|((~X)&Z);};var G=function(X,Y,Z){return(X&Z)|(Y&(~Z));};var H=function(X,Y,Z){return(X^Y^Z);};var I=function(X,Y,Z){return(Y^(X|(~Z)));};var FF=function(a,b,c,d,m,s,t){a=Add(a,Add(Add(F(b,c,d),m),t));return Add(Rotate(a,s),b);};var GG=function(a,b,c,d,m,s,t){a=Add(a,Add(Add(G(b,c,d),m),t));return Add(Rotate(a,s),b);};var HH=function(a,b,c,d,m,s,t){a=Add(a,Add(Add(H(b,c,d),m),t));return Add(Rotate(a,s),b);};var II=function(a,b,c,d,m,s,t){a=Add(a,Add(Add(I(b,c,d),m),t));return Add(Rotate(a,s),b);};var m=SetArray(t);var A;var B;var C;var D;var a=0x67452301;var b=0xEFCDAB89;var c=0x98BADCFE;var d=0x10325476;for(var i=0;i<m.length;i+=16){A=a;B=b;C=c;D=d;a=FF(a,b,c,d,m[i+0],7,0xD76AA478);d=FF(d,a,b,c,m[i+1],12,0xE8C7B756);c=FF(c,d,a,b,m[i+2],17,0x242070DB);b=FF(b,c,d,a,m[i+3],22,0xC1BDCEEE);a=FF(a,b,c,d,m[i+4],7,0xF57C0FAF);d=FF(d,a,b,c,m[i+5],12,0x4787C62A);c=FF(c,d,a,b,m[i+6],17,0xA8304613);b=FF(b,c,d,a,m[i+7],22,0xFD469501);a=FF(a,b,c,d,m[i+8],7,0x698098D8);d=FF(d,a,b,c,m[i+9],12,0x8B44F7AF);c=FF(c,d,a,b,m[i+10],17,0xFFFF5BB1);b=FF(b,c,d,a,m[i+11],22,0x895CD7BE);a=FF(a,b,c,d,m[i+12],7,0x6B901122);d=FF(d,a,b,c,m[i+13],12,0xFD987193);c=FF(c,d,a,b,m[i+14],17,0xA679438E);b=FF(b,c,d,a,m[i+15],22,0x49B40821);a=GG(a,b,c,d,m[i+1],5,0xF61E2562);d=GG(d,a,b,c,m[i+6],9,0xC040B340);c=GG(c,d,a,b,m[i+11],14,0x265E5A51);b=GG(b,c,d,a,m[i+0],20,0xE9B6C7AA);a=GG(a,b,c,d,m[i+5],5,0xD62F105D);d=GG(d,a,b,c,m[i+10],9,0x2441453);c=GG(c,d,a,b,m[i+15],14,0xD8A1E681);b=GG(b,c,d,a,m[i+4],20,0xE7D3FBC8);a=GG(a,b,c,d,m[i+9],5,0x21E1CDE6);d=GG(d,a,b,c,m[i+14],9,0xC33707D6);c=GG(c,d,a,b,m[i+3],14,0xF4D50D87);b=GG(b,c,d,a,m[i+8],20,0x455A14ED);a=GG(a,b,c,d,m[i+13],5,0xA9E3E905);d=GG(d,a,b,c,m[i+2],9,0xFCEFA3F8);c=GG(c,d,a,b,m[i+7],14,0x676F02D9);b=GG(b,c,d,a,m[i+12],20,0x8D2A4C8A);a=HH(a,b,c,d,m[i+5],4,0xFFFA3942);d=HH(d,a,b,c,m[i+8],11,0x8771F681);c=HH(c,d,a,b,m[i+11],16,0x6D9D6122);b=HH(b,c,d,a,m[i+14],23,0xFDE5380C);a=HH(a,b,c,d,m[i+1],4,0xA4BEEA44);d=HH(d,a,b,c,m[i+4],11,0x4BDECFA9);c=HH(c,d,a,b,m[i+7],16,0xF6BB4B60);b=HH(b,c,d,a,m[i+10],23,0xBEBFBC70);a=HH(a,b,c,d,m[i+13],4,0x289B7EC6);d=HH(d,a,b,c,m[i+0],11,0xEAA127FA);c=HH(c,d,a,b,m[i+3],16,0xD4EF3085);b=HH(b,c,d,a,m[i+6],23,0x4881D05);a=HH(a,b,c,d,m[i+9],4,0xD9D4D039);d=HH(d,a,b,c,m[i+12],11,0xE6DB99E5);c=HH(c,d,a,b,m[i+15],16,0x1FA27CF8);b=HH(b,c,d,a,m[i+2],23,0xC4AC5665);a=II(a,b,c,d,m[i+0],6,0xF4292244);d=II(d,a,b,c,m[i+7],10,0x432AFF97);c=II(c,d,a,b,m[i+14],15,0xAB9423A7);b=II(b,c,d,a,m[i+5],21,0xFC93A039);a=II(a,b,c,d,m[i+12],6,0x655B59C3);d=II(d,a,b,c,m[i+3],10,0x8F0CCC92);c=II(c,d,a,b,m[i+10],15,0xFFEFF47D);b=II(b,c,d,a,m[i+1],21,0x85845DD1);a=II(a,b,c,d,m[i+8],6,0x6FA87E4F);d=II(d,a,b,c,m[i+15],10,0xFE2CE6E0);c=II(c,d,a,b,m[i+6],15,0xA3014314);b=II(b,c,d,a,m[i+13],21,0x4E0811A1);a=II(a,b,c,d,m[i+4],6,0xF7537E82);d=II(d,a,b,c,m[i+11],10,0xBD3AF235);c=II(c,d,a,b,m[i+2],15,0x2AD7D2BB);b=II(b,c,d,a,m[i+9],21,0xEB86D391);a=Add(a,A);b=Add(b,B);c=Add(c,C);d=Add(d,D);}
return(BytesToHex(Int32ToBytes(a),"")+BytesToHex(Int32ToBytes(b),"")+BytesToHex(Int32ToBytes(c),"")+BytesToHex(Int32ToBytes(d),"")).toLowerCase();}
function GetBinName(u){var r=new Array();var BinUnit=new Array(["errno_main_client",564],["mrock.active_client",35],["mrock.character_client",644],["mrock.characterproperty_client",327],["mrock.floornode_client",16],["mrock.floorreward_client",186],["mrock.innerpublicnotify_client",928],["mrock.innerrace_client",616],["mrock.luckyturntablereward_client",18],["mrock.luckyturntabletypeshow_client",137],["mrock.marketact_client",152],["mrock.mission_client",414],["mrock.scorebuy_client",22],["mrock.scoreexchange_client",21],["mrock.surviveact_client",263],["mrock.thingbuy_client",31],["mrock.timelimitcharacter_client",284],["mrock_buynew_client",295],["mrock_dailyactive_client",105],["mrock_guild_song_client",28],["mrock_guildactivity_client",332],["mrock_Map_client",57],["mrock_match_client",4156],["mrock_match_division_client",260],["mrock_medal_client",92],["mrock_noble_client",3993],["mrock_noble_gift_client",304],["mrock_papasong_client",361],["mrock_questconfig_client",640],["errno_main_client",564],["mrock_recharge_ios_client",406],["mrock_recharge_android_client",406],["mrock_room_client",24],["mrock_scoreexchange_client",21],["mrock_share_client",268],["mrock_song_client",830],["mrock_song_client_android",830],["mrock_songlevel_client",830],["mrock_SongPkg_client",808],["mrock_starmall_exchange_client",93],["mrock_SysParam_client",8],["mrock_txt_client",260]);for(var i=0;i<BinUnit.length;i++){if(BinUnit[i][1]==u){r.push(BinUnit[i][0]);}}
return r;}</script><script type="text/javascript">String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"");};Array.prototype.add=function(a){if(typeof a.length==="undefined"){a=[a];}
for(var i=0;i<a.length;i++){this[this.length]=a[i];}};Array.prototype.replace=function(r,s){for(var i=0;i<r.length;i++){if(s+i>this.length-1){break;}
this[s+i]=r[i];}};function DuplicateString(t,n){var r=new Array();for(var i=0;i<n;i++){r[i]=t;}
return r.join("");}
function FillString(t,c,n,b){if((t=="")||(c.length!=1)||(n<=t.length)){return t;}
var r=new Array();r.push(t);for(var i=0;i<n-t.length;i++){if(b){r.unshift(c);}
else{r.push(c);}}
return r.join("");}
function InsertString(t,c,n){var r=new Array();for(var i=0;i*2<t.length;i++){r.push(t.substr(i*2,n));}
return r.join(c);}
function LTrimString(t,c){var n=0;for(var i=0;i<t.length;i++){if(t[i]==c){n+=1;}
else{break;}}
return t.substring(n,t.length+1);}
function DuplicateBytes(t,n){var r=new Uint8Array(n);for(var i=0;i<r.length;i++){r[i]=t;}
return r;}
function RTrimBytes(t,c){var n=t.length-1;for(var i=0;i<t.length;i++){if(t[t.length-i-1]==c){n-=1;}
else{break;}}
return SliceBytes(t,0,n+1);}
function SliceBytes(t,s,e){return new Uint8Array(new Uint8Array(t).buffer.slice(s,e));}
function BytesToArray(t){var r=new Array();for(var i=0;i<t.length;i++){r[i]=t[i];}
return r;}
function UnrepeatArray(t){var r=new Array();var h=new Array();for(var i=0,e;(e=t[i])!=null;i++){if(!h[e]){r.push(e);h[e]=true;}}
return r;}
function MajorityArray(t){if((typeof(t)=="undefined")||(t.length==0)){return"";}
if(t.length==1){return t[0];}
var u=UnrepeatArray(t);if(u.length==1){return u[0];}
var c=new Array();for(var i=0;i<u.length;i++){c[i]=0;for(var j=0;j<t.length;j++){if(t[j]==u[i]){c[i]+=1;}}}
var m=c[0];var n=0;for(var i=1;i<c.length;i++){if(c[i]>m){m=c[i];n=i;}}
return u[n];}
function CloseNumber(t,c,v){var r=t;if(Math.abs(t-c)<=v){r=c;}
return r;}
function SortNumber(a,b){return(a-b)}</script><script type="text/javascript">function BytesToBase64(t){var r=new Array();var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var c1;var c2;var c3;var i=0;while(i<t.length){c1=t[i++]&0xFF;if(i==t.length){r.push(c.charAt(c1>>2));r.push(c.charAt((c1&0x3)<<4));r.push("==");break;}
c2=t[i++];if(i==t.length){r.push(c.charAt(c1>>2));r.push(c.charAt(((c1&0x3)<<4)|((c2&0xF0)>>4)));r.push(c.charAt((c2&0xF)<<2));r.push("=");break;}
c3=t[i++];r.push(c.charAt(c1>>2));r.push(c.charAt(((c1&0x3)<<4)|((c2&0xF0)>>4)));r.push(c.charAt(((c2&0xF)<<2)|((c3&0xC0)>>6)));r.push(c.charAt(c3&0x3F));}
return r.join("");}
function Base64ToBytes(t){var r=new Uint8Array(t.length/4*3);var c=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);var c1;var c2;var c3;var c4;var i=0;var j=0;while(i<t.length){do{c1=c[t.charCodeAt(i++)&0xFF];}
while(i<t.length&&c1==-1);if(c1==-1)
break;do{c2=c[t.charCodeAt(i++)&0xFF];}
while(i<t.length&&c2==-1);if(c2==-1)
break;r[j++]=((c1<<2)|((c2&0x30)>>4));do{c3=t.charCodeAt(i++)&0xFF;if(c3==61)
return r;c3=c[c3];}
while(i<t.length&&c3==-1);if(c3==-1)
break;r[j++]=(((c2&0xF)<<4)|((c3&0x3C)>>2));do{c4=t.charCodeAt(i++)&0xFF;if(c4==61)
return r;c4=c[c4];}
while(i<t.length&&c4==-1);if(c4==-1)
break;r[j++]=(((c3&0x03)<<6)|c4);}
return r;}
function BytesToText(t){var r=BytesToHex(t,"");if(r!=""){r=decodeURIComponent("%"+InsertString(r,"%",2));}
return r;}
function TextToBytes(t){t=encodeURIComponent(t);var r=new Array();for(var i=0;i<t.length;i++){if(t.substr(i,1)!="%"){r.push(HexToBytes(t.substr(i,1).charCodeAt().toString(16))[0]);}
else{r.push(HexToBytes(t.substr(i+1,2))[0]);i+=2;}}
return new Uint8Array(r);}
function BytesToHex(t,c){if(t.length==0){return"";}
var r=new Array();for(var i=0;i<t.length;i++){r.push(FillString(t[i].toString(16).toUpperCase(),"0",2,true))}
return r.join(c);}
function HexToBytes(t){if(t==""){return new Uint8Array(0);}
var r=new Array();if(t.length%2!=0){t+="0";}
for(var i=0;i<t.length;i++){var b;try{b=parseInt(t.substr(i,2),16);}
catch(e){b=0;}
r.push(b);i+=1;}
return new Uint8Array(r);}
function BytesToInt16(t){if(t.length>2){t=SliceBytes(t,0,2);}
var a=new Uint8Array(2);a.set(t);return new DataView(a.buffer).getInt16(0,LittleEndian);}
function Int16ToBytes(t){var d=new DataView(new ArrayBuffer(2));d.setInt16(0,t,LittleEndian);return new Uint8Array(d.buffer);}
function BytesToInt32(t){if(t.length>4){t=SliceBytes(t,0,4);}
var a=new Uint8Array(4);a.set(t);return new DataView(a.buffer).getInt32(0,LittleEndian);}
function Int32ToBytes(t){var d=new DataView(new ArrayBuffer(4));d.setInt32(0,t,LittleEndian);return new Uint8Array(d.buffer);}
function BytesToFloat64(t){if(t.length>8){t=SliceBytes(t,0,8);}
var a=new Uint8Array(8);a.set(t);return new DataView(a.buffer).getFloat64(0,LittleEndian);}
function TextToHtml(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/"/g,"&quot;");}
function HtmlToText(t){return t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&quot;/g,'"');}
function Utf8ToUtf16(t){var r=new Array();var c1;var c2;var c3;var i=0;while(i<t.length){c1=t.charCodeAt(i++);switch(c1>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r.push(t.charAt(i-1));break;case 12:case 13:c2=t.charCodeAt(i++);r.push(String.fromCharCode(((c1&0x1F)<<6)|(c2&0x3F)));break;case 14:c2=t.charCodeAt(i++);c3=t.charCodeAt(i++);r.push(String.fromCharCode(((c1&0x0F)<<12)|((c2&0x3F)<<6)|((c3&0x3F)<<0)));break;}}
return r.join("");}
function Utf16ToUtf8(t){var r=new Array();var c;for(var i=0;i<t.length;i++){c=t.charCodeAt(i);if((c>=0x0001)&&(c<=0x007F)){r.push(t.charAt(i));}
else if(c>0x07FF){r.push(String.fromCharCode(0xE0|((c>>12)&0x0F)));r.push(String.fromCharCode(0x80|((c>>6)&0x3F)));r.push(String.fromCharCode(0x80|((c>>0)&0x3F)));}
else{r.push(String.fromCharCode(0xC0|((c>>6)&0x1F)));r.push(String.fromCharCode(0x80|((c>>0)&0x3F)));}}
return r.join("");}
function MillisecondToTime(t){var ms=t;var m=Math.floor(ms/60000);ms-=m*60000;var s=Math.floor(ms/1000);ms-=s*1000;return m.toString()+":"+s.toString()+"."+ms.toString();}</script><script type="text/javascript">function TxtToTxt(b){if(b.length==0){return"";}
return BytesToText(b);}
function BinToXml(b){if(b.length==0){return"";}
var ReadByte=function(){var r=LTrimString(BytesToHex(SliceBytes(b,p,p+1),"").toLowerCase(),"0");if(r==""){r="0";}
p+=1;return"0x"+r+" ";}
var ReadInt16=function(){var r=BytesToInt16(SliceBytes(b,p,p+2));p+=2;return r.toString()+" ";}
var ReadInt32=function(){var r=BytesToInt32(SliceBytes(b,p,p+4));p+=4;return r.toString()+" ";}
var ReadDateTime=function(){var y=BytesToInt32(SliceBytes(b,p,p+4));p+=4;var M=BytesToInt16(SliceBytes(b,p,p+2));p+=2;var d=BytesToInt16(SliceBytes(b,p,p+2));p+=2;var H=BytesToInt16(SliceBytes(b,p,p+2));p+=2;var m=BytesToInt16(SliceBytes(b,p,p+2));p+=2;var s=BytesToInt16(SliceBytes(b,p,p+2));p+=2;return FillString(y.toString()," ",4,true).replace(/ /g,"&nbsp;")+"-"+FillString(M.toString(),"0",2,true)+"-"+FillString(d.toString(),"0",2,true)+" "+FillString(H.toString(),"0",2,true)+":"+FillString(m.toString(),"0",2,true)+":"+FillString(s.toString(),"0",2,true);}
var ReadText=function(n){var r=BytesToText(RTrimBytes(SliceBytes(b,p,p+n),0));p+=n;return r;}
var ReadData=function(n){switch(n){case 1:return ReadByte();break;case 2:return ReadInt16();break;case 4:return ReadInt32();break;case 14:return ReadDateTime();break;case 20:case 22:case 32:case 48:case 64:case 128:case 200:case 256:case 300:case 512:case 1024:return ReadText(n);break;default:p+=n;return"";}}
var WriteData=function(l,f,c){xml.push(DuplicateString("&nbsp;",4*l)+"&lt;"+f+"&gt;"+c+"&lt;/"+f+"&gt;");}
var WriteDataA=function(l,f,n){WriteData(l,f,ReadData(n));}
var WriteDataE=function(l,f,t,n){for(var i=0;i<n;i++){switch(f){case"TResHeadAll":xml.push(DuplicateString("&nbsp;",4*l)+"&lt;"+f+"&nbsp;version=&quot;5&quot;&gt;");xml.push(DuplicateString("&nbsp;",4*(l+1))+"&lt;resHead type=&quot;TResHead&quot;&gt;");xml.push(DuplicateString("&nbsp;",4*(l+2))+"&lt;Magic&gt;1397052237 &lt;/Magic&gt;");WriteDataA(l+2,"Version",4);WriteDataA(l+2,"Unit",4);WriteDataA(l+2,"Count",4);WriteDataA(l+2,"MetalibHash",32);WriteDataA(l+2,"ResVersion",2);WriteDataA(l+2,"CreateTime",14);WriteDataA(l+2,"ResEncording",32);WriteDataA(l+2,"ContentHash",32);p+=4;xml.push(DuplicateString("&nbsp;",4*(l+1))+"&lt;/resHead&gt;");xml.push(DuplicateString("&nbsp;",4*(l+1))+"&lt;resHeadExt&nbsp;type=&quot;TResHeadExt&quot;&gt;");WriteDataA(l+2,"DataOffset",4);xml.push(DuplicateString("&nbsp;",4*(l+1))+"&lt;/resHeadExt&gt;");xml.push(DuplicateString("&nbsp;",4*l)+"&lt;/"+f+"&gt;");break;case"m_astReward":switch(t){case"ActiveReward":var c1=ReadData(1);var c2=ReadData(4);var c3=ReadData(4);if(!((c1=="0x0 ")&&(c2=="0 ")&&(c3=="0 "))){xml.push(DuplicateString("&nbsp;",4*l)+"&lt;"+f+" type=&quot;"+t+"&quot;&gt;");WriteData(l+1,"m_ucRewardType",c1);WriteData(l+1,"m_iRewardID",c2);WriteData(l+1,"m_iRewardValue",c3);xml.push(DuplicateString("&nbsp;",4*l)+"&lt;/"+f+"&gt;");}
break;case"MarketActReward":var c1=ReadData(1);var c2=ReadData(2);var c3=ReadData(4);if(!((c1=="0x0 ")&&(c2=="0 ")&&(c3=="0 "))){xml.push(DuplicateString("&nbsp;",4*l)+"&lt;"+f+" type=&quot;"+t+"&quot;&gt;");WriteData(l+1,"m_ucRewardType",c1);WriteData(l+1,"m_ushRewardID",c2);WriteData(l+1,"m_iRewardValue",c3);xml.push(DuplicateString("&nbsp;",4*l)+"&lt;/"+f+"&gt;");}
break;}
break;case"m_astSongs":var c=ReadData(2);if(!(c=="0 ")){xml.push(DuplicateString("&nbsp;",4*l)+"&lt;"+f+" type=&quot;"+t+"&quot;&gt;");WriteData(l+1,"ID",c);xml.push(DuplicateString("&nbsp;",4*l)+"&lt;/"+f+"&gt;");}
break;}}}
var WriteDataT=function(t,m,d){p=4;xml.push("&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot; ?&gt;");xml.push("&lt;"+t+"&gt;");WriteDataE(0,"TResHeadAll","",1);while(p<b.length){xml.push("&lt;"+m+" version=&quot;1&quot;&gt;");for(var i=0;i<d.length;i++){switch(d[i][0]){case 0:WriteDataA(1,d[i][1],d[i][2]);break;case 1:var a=d[i][1].split(",");WriteDataE(1,a[0],a[1],d[i][2]);break;}}
xml.push("&lt;/"+m+"&gt;");}
xml.push("&lt;/"+t+"&gt;");}
var xml=new Array();var p=0;var d=new Array();switch(GetFileName(OptimizeName(FileName))){case"errno_main_client":d.push(new Array(0,"m_szName",48));d.push(new Array(0,"m_uiValue",4));d.push(new Array(0,"m_szDescriptionZH",256));d.push(new Array(0,"m_szDescriptionEN",256));WriteDataT("ErrnoConfig_Client_Tab","ErrnoConfig_Client",d);break;case"mrock.active_client":d.push(new Array(0,"m_ushActiveID",2));d.push(new Array(0,"m_ucActiveType",1));d.push(new Array(0,"m_iNumber",4));d.push(new Array(0,"m_ucRewardNumber",1));d.push(new Array(1,"m_astReward,ActiveReward",3));WriteDataT("ActiveConfig_Client_Tab","ActiveConfig_Client",d);break;case"mrock.character_client":d.push(new Array(0,"m_usID",2));d.push(new Array(0,"m_usIconID",2));d.push(new Array(0,"m_szDesc",256));d.push(new Array(0,"m_szNoteDesc",256));d.push(new Array(0,"m_szNoteStyle1",32));d.push(new Array(0,"m_szNoteStyle2",32));d.push(new Array(0,"m_szNoteStyle3",32));d.push(new Array(0,"m_szGameSpeaking",32));WriteDataT("CharacterConfig_Client_Tab","CharacterConfig_Client",d);break;case"mrock.characterproperty_client":d.push(new Array(0,"m_usID",2));d.push(new Array(0,"m_ucPropertyID",1));d.push(new Array(0,"m_ucType",1));d.push(new Array(0,"m_usIconID",2));d.push(new Array(0,"m_ucEffectType",1));d.push(new Array(0,"m_szName",32));d.push(new Array(0,"m_szEffect",32));d.push(new Array(0,"m_szDesc",256));WriteDataT("CharacterPropertyConfig_Client_Tab","CharacterPropertyConfig_Client",d);break;case"mrock.floornode_client":d.push(new Array(0,"m_iNodeID",4));d.push(new Array(0,"m_iNodeType",4));d.push(new Array(0,"m_iNodeValue",4));d.push(new Array(0,"m_iPlayStyle",4));WriteDataT("FloorNodeConfig_Client_Tab","FloorNodeConfig_Client",d);break;case"mrock.floorreward_client":d.push(new Array(0,"m_iRewardID",4));d.push(new Array(0,"m_ucRewardType",1));d.push(new Array(0,"m_iRewardValue",4));WriteDataT("FloorRewardConfig_Client_Tab","FloorRewardConfig_Client",d);break;case"mrock.innerpublicnotify_client":d.push(new Array(0,"m_iID",4));d.push(new Array(0,"m_iLevel",4));d.push(new Array(0,"m_iLinkType",4));d.push(new Array(0,"m_iContentType",4));d.push(new Array(0,"m_szTitle",300));d.push(new Array(0,"m_szContent",300));d.push(new Array(0,"m_szUrl",300));d.push(new Array(0,"m_iForce",4));d.push(new Array(0,"m_iPhonetype",4));d.push(new Array(0,"m_iLoginType",4));WriteDataT("InnerPublicNotifyConfig_Client_Tab","InnerPublicNotifyConfig_Client",d);break;case"mrock.innerrace_client":d.push(new Array(0,"m_iMatchID",4));d.push(new Array(0,"m_iLevel",4));d.push(new Array(0,"m_iContentType",4));d.push(new Array(0,"m_szTitle",300));d.push(new Array(0,"m_szContent",300));d.push(new Array(0,"m_iPhonetype",4));WriteDataT("InnerRaceConfig_Client_Tab","InnerRaceConfig_Client",d);break;case"mrock.luckyturntablereward_client":break;case"mrock.luckyturntabletypeshow_client":break;case"mrock.marketact_client":d.push(new Array(0,"m_ushMarketActID",2));d.push(new Array(0,"m_szDescription",128));d.push(new Array(0,"m_ucRewardNumber",1));d.push(new Array(1,"m_astReward,MarketActReward",3));WriteDataT("MarketActConfig_Client_Tab","MarketActConfig_Client",d);break;case"mrock.mission_client":d.push(new Array(0,"m_iMissionID",4));d.push(new Array(0,"m_szTitle",128));d.push(new Array(0,"m_iIconID",4));d.push(new Array(0,"m_szDiffDesc",64));d.push(new Array(0,"m_szDiffColor",64));d.push(new Array(0,"m_szBeginTime",64));d.push(new Array(0,"m_szEndTime",64));d.push(new Array(0,"m_iStartFloor",4));d.push(new Array(0,"m_iEndFloor",4));d.push(new Array(0,"m_ucResetable",4));d.push(new Array(0,"m_iResetCost",4));d.push(new Array(0,"m_ucRewardType",1));d.push(new Array(0,"m_ucIsNew",1));d.push(new Array(0,"m_iSeqID",4));WriteDataT("MissionConfig_Client_Tab","MissionConfig_Client",d);break;case"mrock.scorebuy_client":d.push(new Array(0,"m_iBuyID",4));d.push(new Array(0,"m_ucItemType",1));d.push(new Array(0,"m_iItemID",4));d.push(new Array(0,"m_iItemValue",4));d.push(new Array(0,"m_iScorePresent",4));d.push(new Array(0,"m_ucBuyType",1));d.push(new Array(0,"m_iCostNum",4));WriteDataT("ScoreBuyConfig_Client_Tab","ScoreBuyConfig_Client",d);break;case"mrock.scoreexchange_client":case"mrock_scoreexchange_client":d.push(new Array(0,"m_iExchangeID",4));d.push(new Array(0,"m_ucItemType",1));d.push(new Array(0,"m_iItemID",4));d.push(new Array(0,"m_iItemValue",4));d.push(new Array(0,"m_iScoreCost",4));d.push(new Array(0,"m_iVersion",4));WriteDataT("ScoreExchangeConfig_Client_Tab","ScoreExchangeConfig_Client",d);break;case"mrock.surviveact_client":d.push(new Array(0,"m_iID",4));d.push(new Array(0,"m_ushSongID",2));d.push(new Array(0,"m_ucNoteType",1));d.push(new Array(0,"m_szOpenTimeDesc",256));WriteDataT("SurviveActConfig_Client_Tab","SurviveActConfig_Client",d);break;case"mrock.thingbuy_client":break;case"mrock.timelimitcharacter_client":d.push(new Array(0,"m_ushID",2));d.push(new Array(0,"m_ushCharacterID",2));d.push(new Array(0,"m_ushInitLevel",2));d.push(new Array(0,"m_szName",22));d.push(new Array(0,"m_szDesc",256));WriteDataT("TimeLimitCharacterConfig_Client_Tab","TimeLimitCharacterConfig_Client",d);break;case"mrock_buynew_client":d.push(new Array(0,"m_ushID",2));d.push(new Array(0,"m_ucType",1));d.push(new Array(0,"m_iThingID",4));d.push(new Array(0,"m_szItemName",128));d.push(new Array(0,"m_iThingNumber",4));d.push(new Array(0,"m_iIOSMoney",4));d.push(new Array(0,"m_iAndroidMoney",4));d.push(new Array(0,"m_iDiamonds",4));d.push(new Array(0,"m_szDescriptionName",128));d.push(new Array(0,"m_iIconID",4));d.push(new Array(0,"m_iIsopen",4));d.push(new Array(0,"m_iSequence",4));d.push(new Array(0,"m_iIsone",4));WriteDataT("BuyConfig_Client_Tab","BuyConfig_Client",d);break;case"mrock_dailyactive_client":break;case"mrock_guild_song_client":break;case"mrock_guildactivity_client":break;case"mrock_Map_client":break;case"mrock_match_client":d.push(new Array(0,"m_iMatchIndex",4));d.push(new Array(0,"m_iRegion",4));d.push(new Array(0,"m_iType",4));d.push(new Array(0,"m_szBeginTime",64));d.push(new Array(0,"m_szEndTime",64));d.push(new Array(0,"m_iElectNumber",4));d.push(new Array(0,"m_iGroupNumber",4));d.push(new Array(0,"m_szApplySuccess",64));d.push(new Array(0,"m_szTitle",64));d.push(new Array(0,"m_szTitle1",64));d.push(new Array(0,"m_szContent1",200));d.push(new Array(0,"m_szTitle2",64));d.push(new Array(0,"m_szContent2",200));d.push(new Array(0,"m_szTitle3",64));d.push(new Array(0,"m_szContent3",1024));d.push(new Array(0,"m_szContentPage201",200));d.push(new Array(0,"m_szContentPage202",200));d.push(new Array(0,"m_szContentPage203",200));d.push(new Array(0,"m_szContentPage204",200));d.push(new Array(0,"m_szContentPage205",200));d.push(new Array(0,"m_szTimeDesc",200));d.push(new Array(0,"m_szPostTitle",64));d.push(new Array(0,"m_szPostDesc1",200));d.push(new Array(0,"m_szPostDesc2",200));d.push(new Array(0,"m_szPostDesc3",200));d.push(new Array(0,"m_szPostDesc4",200));d.push(new Array(0,"m_szStageName",200));WriteDataT("MatchConfig_Client_Tab","MatchConfig_Client",d);break;case"mrock_match_division_client":d.push(new Array(0,"m_iMatchID",4));d.push(new Array(0,"m_szFilterSort1",64));d.push(new Array(0,"m_szFilterSort2",64));d.push(new Array(0,"m_szFilter1",64));d.push(new Array(0,"m_szFilter2",64));WriteDataT("MatchDivisionConfig_Client_Tab","MatchDivisionConfig_Client",d);break;case"mrock_medal_client":break;case"mrock_noble_client":break;case"mrock_noble_gift_client":break;case"mrock_papasong_client":d.push(new Array(0,"m_ushSongID",2));d.push(new Array(0,"m_iVersion",4));d.push(new Array(0,"m_szSongName",64));d.push(new Array(0,"m_cDifficulty",1));d.push(new Array(0,"m_cLevel",1));d.push(new Array(0,"m_szPath",64));d.push(new Array(0,"m_szArtist",64));d.push(new Array(0,"m_szSongTime",64));d.push(new Array(0,"m_iGameTime",4));d.push(new Array(0,"m_szRegion",20));d.push(new Array(0,"m_szStyle",20));d.push(new Array(0,"m_szBPM",20));d.push(new Array(0,"m_szNoteNumber",20));d.push(new Array(0,"m_iOrderIndex",4));d.push(new Array(0,"m_ucIsOpen",1));d.push(new Array(0,"m_ucIsFree",1));d.push(new Array(0,"m_ucIsHide",1));d.push(new Array(0,"m_ucIsReward",1));d.push(new Array(0,"m_ucIsLevelReward",1));d.push(new Array(0,"m_iSongType",4));WriteDataT("PapaSongConfig_Client_Tab","PapaSongConfig_Client",d);break;case"mrock_questconfig_client":d.push(new Array(0,"m_iQuestId",4));d.push(new Array(0,"m_szQuestName",300));d.push(new Array(0,"m_szDescription",300));d.push(new Array(0,"m_iMethod",4));d.push(new Array(0,"m_iNodeType",4));d.push(new Array(0,"m_iNodeValue",4));d.push(new Array(0,"m_iNodeLimit",4));d.push(new Array(0,"m_iSongNodeID",4));d.push(new Array(0,"m_iSongNodeNoteType",4));d.push(new Array(0,"m_iRewardType",4));d.push(new Array(0,"m_iRewardID",4));d.push(new Array(0,"m_iRewardValue",4));WriteDataT("QuestConfig_Client_Tab","QuestConfig_Client",d);break;case"mrock_recharge_ios_client":case"mrock_recharge_android_client":break;case"mrock_room_client":d.push(new Array(0,"m_ushRoomID",2));d.push(new Array(0,"m_ucSongType",1));d.push(new Array(0,"m_ucTicketType",1));d.push(new Array(0,"m_iTicketNum",4));d.push(new Array(0,"m_ucRewardType",1));d.push(new Array(0,"m_iRewardNum",4));d.push(new Array(0,"m_iRewardIntergral",4));d.push(new Array(0,"m_ucIsOpen",1));d.push(new Array(0,"m_ucIsNewOpen",1));d.push(new Array(0,"m_ucIsProp",1));d.push(new Array(0,"m_iMinClientVersion",4));WriteDataT("RoomConfig_Client_Tab","RoomConfig_Client",d);break;case"mrock_share_client":break;case"mrock_song_client":case"mrock_song_client_android":case"mrock_songlevel_client":d.push(new Array(0,"m_ushSongID",2));d.push(new Array(0,"m_iVersion",4));d.push(new Array(0,"m_szSongName",64));d.push(new Array(0,"m_szPath",64));d.push(new Array(0,"m_szArtist",64));d.push(new Array(0,"m_szComposer",64));d.push(new Array(0,"m_szSongTime",64));d.push(new Array(0,"m_iGameTime",4));d.push(new Array(0,"m_iRegion",4));d.push(new Array(0,"m_iStyle",4));d.push(new Array(0,"m_ucIsNew",2));d.push(new Array(0,"m_ucIsHot",2));d.push(new Array(0,"m_ucIsRecommend",2));d.push(new Array(0,"m_szBPM",64));d.push(new Array(0,"m_ucIsOpen",2));d.push(new Array(0,"m_ucCanBuy",1));d.push(new Array(0,"m_iOrderIndex",4));d.push(new Array(0,"m_bIsFree",1));d.push(new Array(0,"m_bSongPkg",1));d.push(new Array(0,"m_szFreeBeginTime",64));d.push(new Array(0,"m_szFreeEndTime",64));d.push(new Array(0,"m_ush4KeyEasy",2));d.push(new Array(0,"m_ush4KeyNormal",2));d.push(new Array(0,"m_ush4KeyHard",2));d.push(new Array(0,"m_ush5KeyEasy",2));d.push(new Array(0,"m_ush5KeyNormal",2));d.push(new Array(0,"m_ush5KeyHard",2));d.push(new Array(0,"m_ush6KeyEasy",2));d.push(new Array(0,"m_ush6KeyNormal",2));d.push(new Array(0,"m_ush6KeyHard",2));d.push(new Array(0,"m_iPrice",4));d.push(new Array(0,"m_szNoteNumber",128));d.push(new Array(0,"m_szProductID",128));d.push(new Array(0,"m_iVipFlag",4));d.push(new Array(0,"m_bIsHide",1));d.push(new Array(0,"m_bIsReward",1));d.push(new Array(0,"m_bIsLevelReward",1));WriteDataT("SongConfig_Client_Tab","SongConfig_Client",d);break;case"mrock_SongPkg_client":d.push(new Array(0,"m_ushIndex",2));d.push(new Array(0,"m_szProductID",128));d.push(new Array(0,"m_szDesc",512));d.push(new Array(0,"m_szPath",128));d.push(new Array(0,"m_iAndroidPrice",4));d.push(new Array(0,"m_iPrice",4));d.push(new Array(0,"m_iEnable",4));d.push(new Array(0,"m_bIsNew",1));d.push(new Array(0,"m_bIsHot",1));d.push(new Array(0,"m_iNum",4));d.push(new Array(1,"m_astSongs,PkgSong",10));WriteDataT("SongPkgConfig_Client_Tab","SongPkgConfig_Client",d);break;case"mrock_starmall_exchange_client":break;case"mrock_SysParam_client":d.push(new Array(0,"m_iParamID",4));d.push(new Array(0,"m_iParamValue",4));WriteDataT("SysParamConfig_Client_Tab","SysParamConfig_Client",d);break;case"mrock_txt_client":d.push(new Array(0,"m_uiID",4));d.push(new Array(0,"m_szDescriptionZH",256));WriteDataT("TxtConfig_Client_Tab","TxtConfig_Client",d);break;}
return HtmlToText(xml.join("\r\n"));}
function XmlToBin(b){if(b.length==0){return"";}
b=BytesToText(b).replace(/\r\n/g,"");var ReadData=function(f1,f2){var r;var s1=b.indexOf(f1,p);if(s1==-1){p=b.length;return"";}
else{s1+=f1.length;}
var s2=b.indexOf(f2,s1);if(s2==-1){p=b.length;return"";}
p=s2+f2.length;return b.substring(s1,s2);}
var WriteByte=function(c){if(c==""){c="0x0 "}
if((c.indexOf("0x")==0)&&(c.lastIndexOf(" ")==(c.length-1))){bin.add(parseInt(c,16));}}
var WriteInt16=function(c){if(c==""){c="0 "}
if(c.lastIndexOf(" ")==(c.length-1)){bin.add(BytesToArray(Int16ToBytes(parseInt(c,10))));}}
var WriteInt32=function(c){if(c==""){c="0 "}
if(c.lastIndexOf(" ")==(c.length-1)){bin.add(BytesToArray(Int32ToBytes(parseInt(c,10))));}}
var WriteDateTime=function(c){if(c==""){c="   0-00-00 00:00:00"}
var a=c.split("-");var y=a[0];WriteInt32(y.toString()+" ");var M=a[1];WriteInt16(M.toString()+" ");a=a[2].split(" ");var d=a[0];WriteInt16(d.toString()+" ");a=a[1].split(":");var H=a[0];WriteInt16(H.toString()+" ");var m=a[1];WriteInt16(m.toString()+" ");var s=a[2];WriteInt16(s.toString()+" ");}
var WriteText=function(c,n){var r=BytesToArray(TextToBytes(c));bin.add(r);bin.add(BytesToArray(DuplicateBytes(0,n-r.length)));}
var WriteData=function(c,n){switch(n){case 1:WriteByte(c);break;case 2:WriteInt16(c);break;case 4:WriteInt32(c);break;case 14:WriteDateTime(c);break;case 20:case 22:case 32:case 48:case 64:case 128:case 200:case 256:case 300:case 512:case 1024:WriteText(c,n);break;}}
var WriteDataE=function(f,t,n){var l=new Array();for(var i=0;i<n;i++){if(f=="TResHeadAll"){l.push(b);}
else{l.push(ReadData("<"+f+" type="+'"'+t+'"'+">","</"+f+">"));}}
for(var i=0;i<l.length;i++){b=l[i];p=0;switch(f){case"TResHeadAll":WriteData(ReadData("<Version>","</Version>"),4);WriteData(ReadData("<Unit>","</Unit>"),4);WriteData(ReadData("<Count>","</Count>"),4);WriteData(ReadData("<MetalibHash>","</MetalibHash>"),32);WriteData(ReadData("<ResVersion>","</ResVersion>"),2);WriteData(ReadData("<CreateTime>","</CreateTime>"),14);WriteData(ReadData("<ResEncording>","</ResEncording>"),32);WriteData(ReadData("<ContentHash>","</ContentHash>"),32);WriteData("",4);WriteData(ReadData("<DataOffset>","</DataOffset>"),4);break;case"m_astReward":switch(t){case"ActiveReward":if(b!=""){WriteData(ReadData("<m_ucRewardType>","</m_ucRewardType>"),1);WriteData(ReadData("<m_iRewardID>","</m_iRewardID>"),4);WriteData(ReadData("<m_iRewardValue>","</m_iRewardValue>"),4);}
else{WriteData("",1);WriteData("",4);WriteData("",4);}
break;case"MarketActReward":if(b!=""){WriteData(ReadData("<m_ucRewardType>","</m_ucRewardType>"),1);WriteData(ReadData("<m_ushRewardID>","</m_ushRewardID>"),2);WriteData(ReadData("<m_iRewardValue>","</m_iRewardValue>"),4);}
else{WriteData("",1);WriteData("",2);WriteData("",4);}
break;}
break;case"m_astSongs":if(b!=""){WriteData(ReadData("<ID>","</ID>"),2);}
else{WriteData("",2);}
break;}}}
var WriteDataT=function(t,m,d){b=ReadData("<"+t+">","</"+t+">");p=0;bin=BytesToArray(TextToBytes("MSES"));WriteDataE("TResHeadAll","",1);var l=new Array();while(p<b.length){l.push(ReadData("<"+m+" version="+'"'+"1"+'"'+">","</"+m+">"))}
for(var i=0;i<l.length;i++){b=l[i];p=0;for(var j=0;j<d.length;j++){switch(d[j][0]){case 0:WriteData(ReadData("<"+d[j][1]+">","</"+d[j][1]+">"),d[j][2]);break;case 1:var a=d[j][1].split(",");WriteDataE(a[0],a[1],d[j][2]);break;}}}
bin.replace(BytesToArray(Int32ToBytes(l.length)),12);bin.replace(TextToBytes(GetMD5(bin.slice(136,bin.length))),96);}
var bin=new Array();var p=0;var d=new Array();switch(GetFileName(OptimizeName(FileName))){case"errno_main_client":d.push(new Array(0,"m_szName",48));d.push(new Array(0,"m_uiValue",4));d.push(new Array(0,"m_szDescriptionZH",256));d.push(new Array(0,"m_szDescriptionEN",256));WriteDataT("ErrnoConfig_Client_Tab","ErrnoConfig_Client",d);break;case"mrock.active_client":d.push(new Array(0,"m_ushActiveID",2));d.push(new Array(0,"m_ucActiveType",1));d.push(new Array(0,"m_iNumber",4));d.push(new Array(0,"m_ucRewardNumber",1));d.push(new Array(1,"m_astReward,ActiveReward",3));WriteDataT("ActiveConfig_Client_Tab","ActiveConfig_Client",d);break;case"mrock.character_client":d.push(new Array(0,"m_usID",2));d.push(new Array(0,"m_usIconID",2));d.push(new Array(0,"m_szDesc",256));d.push(new Array(0,"m_szNoteDesc",256));d.push(new Array(0,"m_szNoteStyle1",32));d.push(new Array(0,"m_szNoteStyle2",32));d.push(new Array(0,"m_szNoteStyle3",32));d.push(new Array(0,"m_szGameSpeaking",32));WriteDataT("CharacterConfig_Client_Tab","CharacterConfig_Client",d);break;case"mrock.characterproperty_client":d.push(new Array(0,"m_usID",2));d.push(new Array(0,"m_ucPropertyID",1));d.push(new Array(0,"m_ucType",1));d.push(new Array(0,"m_usIconID",2));d.push(new Array(0,"m_ucEffectType",1));d.push(new Array(0,"m_szName",32));d.push(new Array(0,"m_szEffect",32));d.push(new Array(0,"m_szDesc",256));WriteDataT("CharacterPropertyConfig_Client_Tab","CharacterPropertyConfig_Client",d);break;case"mrock.floornode_client":d.push(new Array(0,"m_iNodeID",4));d.push(new Array(0,"m_iNodeType",4));d.push(new Array(0,"m_iNodeValue",4));d.push(new Array(0,"m_iPlayStyle",4));WriteDataT("FloorNodeConfig_Client_Tab","FloorNodeConfig_Client",d);break;case"mrock.floorreward_client":d.push(new Array(0,"m_iRewardID",4));d.push(new Array(0,"m_ucRewardType",1));d.push(new Array(0,"m_iRewardValue",4));WriteDataT("FloorRewardConfig_Client_Tab","FloorRewardConfig_Client",d);break;case"mrock.innerpublicnotify_client":d.push(new Array(0,"m_iID",4));d.push(new Array(0,"m_iLevel",4));d.push(new Array(0,"m_iLinkType",4));d.push(new Array(0,"m_iContentType",4));d.push(new Array(0,"m_szTitle",300));d.push(new Array(0,"m_szContent",300));d.push(new Array(0,"m_szUrl",300));d.push(new Array(0,"m_iForce",4));d.push(new Array(0,"m_iPhonetype",4));d.push(new Array(0,"m_iLoginType",4));WriteDataT("InnerPublicNotifyConfig_Client_Tab","InnerPublicNotifyConfig_Client",d);break;case"mrock.innerrace_client":d.push(new Array(0,"m_iMatchID",4));d.push(new Array(0,"m_iLevel",4));d.push(new Array(0,"m_iContentType",4));d.push(new Array(0,"m_szTitle",300));d.push(new Array(0,"m_szContent",300));d.push(new Array(0,"m_iPhonetype",4));WriteDataT("InnerRaceConfig_Client_Tab","InnerRaceConfig_Client",d);break;case"mrock.luckyturntablereward_client":break;case"mrock.luckyturntabletypeshow_client":break;case"mrock.marketact_client":d.push(new Array(0,"m_ushMarketActID",2));d.push(new Array(0,"m_szDescription",128));d.push(new Array(0,"m_ucRewardNumber",1));d.push(new Array(1,"m_astReward,MarketActReward",3));WriteDataT("MarketActConfig_Client_Tab","MarketActConfig_Client",d);break;case"mrock.mission_client":d.push(new Array(0,"m_iMissionID",4));d.push(new Array(0,"m_szTitle",128));d.push(new Array(0,"m_iIconID",4));d.push(new Array(0,"m_szDiffDesc",64));d.push(new Array(0,"m_szDiffColor",64));d.push(new Array(0,"m_szBeginTime",64));d.push(new Array(0,"m_szEndTime",64));d.push(new Array(0,"m_iStartFloor",4));d.push(new Array(0,"m_iEndFloor",4));d.push(new Array(0,"m_ucResetable",4));d.push(new Array(0,"m_iResetCost",4));d.push(new Array(0,"m_ucRewardType",1));d.push(new Array(0,"m_ucIsNew",1));d.push(new Array(0,"m_iSeqID",4));WriteDataT("MissionConfig_Client_Tab","MissionConfig_Client",d);break;case"mrock.scorebuy_client":d.push(new Array(0,"m_iBuyID",4));d.push(new Array(0,"m_ucItemType",1));d.push(new Array(0,"m_iItemID",4));d.push(new Array(0,"m_iItemValue",4));d.push(new Array(0,"m_iScorePresent",4));d.push(new Array(0,"m_ucBuyType",1));d.push(new Array(0,"m_iCostNum",4));WriteDataT("ScoreBuyConfig_Client_Tab","ScoreBuyConfig_Client",d);break;case"mrock.scoreexchange_client":case"mrock_scoreexchange_client":d.push(new Array(0,"m_iExchangeID",4));d.push(new Array(0,"m_ucItemType",1));d.push(new Array(0,"m_iItemID",4));d.push(new Array(0,"m_iItemValue",4));d.push(new Array(0,"m_iScoreCost",4));d.push(new Array(0,"m_iVersion",4));WriteDataT("ScoreExchangeConfig_Client_Tab","ScoreExchangeConfig_Client",d);break;case"mrock.surviveact_client":d.push(new Array(0,"m_iID",4));d.push(new Array(0,"m_ushSongID",2));d.push(new Array(0,"m_ucNoteType",1));d.push(new Array(0,"m_szOpenTimeDesc",256));WriteDataT("SurviveActConfig_Client_Tab","SurviveActConfig_Client",d);break;case"mrock.thingbuy_client":break;case"mrock.timelimitcharacter_client":d.push(new Array(0,"m_ushID",2));d.push(new Array(0,"m_ushCharacterID",2));d.push(new Array(0,"m_ushInitLevel",2));d.push(new Array(0,"m_szName",22));d.push(new Array(0,"m_szDesc",256));WriteDataT("TimeLimitCharacterConfig_Client_Tab","TimeLimitCharacterConfig_Client",d);break;case"mrock_buynew_client":d.push(new Array(0,"m_ushID",2));d.push(new Array(0,"m_ucType",1));d.push(new Array(0,"m_iThingID",4));d.push(new Array(0,"m_szItemName",128));d.push(new Array(0,"m_iThingNumber",4));d.push(new Array(0,"m_iIOSMoney",4));d.push(new Array(0,"m_iAndroidMoney",4));d.push(new Array(0,"m_iDiamonds",4));d.push(new Array(0,"m_szDescriptionName",128));d.push(new Array(0,"m_iIconID",4));d.push(new Array(0,"m_iIsopen",4));d.push(new Array(0,"m_iSequence",4));d.push(new Array(0,"m_iIsone",4));WriteDataT("BuyConfig_Client_Tab","BuyConfig_Client",d);break;case"mrock_dailyactive_client":break;case"mrock_guild_song_client":break;case"mrock_guildactivity_client":break;case"mrock_Map_client":break;case"mrock_match_client":d.push(new Array(0,"m_iMatchIndex",4));d.push(new Array(0,"m_iRegion",4));d.push(new Array(0,"m_iType",4));d.push(new Array(0,"m_szBeginTime",64));d.push(new Array(0,"m_szEndTime",64));d.push(new Array(0,"m_iElectNumber",4));d.push(new Array(0,"m_iGroupNumber",4));d.push(new Array(0,"m_szApplySuccess",64));d.push(new Array(0,"m_szTitle",64));d.push(new Array(0,"m_szTitle1",64));d.push(new Array(0,"m_szContent1",200));d.push(new Array(0,"m_szTitle2",64));d.push(new Array(0,"m_szContent2",200));d.push(new Array(0,"m_szTitle3",64));d.push(new Array(0,"m_szContent3",1024));d.push(new Array(0,"m_szContentPage201",200));d.push(new Array(0,"m_szContentPage202",200));d.push(new Array(0,"m_szContentPage203",200));d.push(new Array(0,"m_szContentPage204",200));d.push(new Array(0,"m_szContentPage205",200));d.push(new Array(0,"m_szTimeDesc",200));d.push(new Array(0,"m_szPostTitle",64));d.push(new Array(0,"m_szPostDesc1",200));d.push(new Array(0,"m_szPostDesc2",200));d.push(new Array(0,"m_szPostDesc3",200));d.push(new Array(0,"m_szPostDesc4",200));d.push(new Array(0,"m_szStageName",200));WriteDataT("MatchConfig_Client_Tab","MatchConfig_Client",d);break;case"mrock_match_division_client":d.push(new Array(0,"m_iMatchID",4));d.push(new Array(0,"m_szFilterSort1",64));d.push(new Array(0,"m_szFilterSort2",64));d.push(new Array(0,"m_szFilter1",64));d.push(new Array(0,"m_szFilter2",64));WriteDataT("MatchDivisionConfig_Client_Tab","MatchDivisionConfig_Client",d);break;case"mrock_medal_client":break;case"mrock_noble_client":break;case"mrock_noble_gift_client":break;case"mrock_papasong_client":d.push(new Array(0,"m_ushSongID",2));d.push(new Array(0,"m_iVersion",4));d.push(new Array(0,"m_szSongName",64));d.push(new Array(0,"m_cDifficulty",1));d.push(new Array(0,"m_cLevel",1));d.push(new Array(0,"m_szPath",64));d.push(new Array(0,"m_szArtist",64));d.push(new Array(0,"m_szSongTime",64));d.push(new Array(0,"m_iGameTime",4));d.push(new Array(0,"m_szRegion",20));d.push(new Array(0,"m_szStyle",20));d.push(new Array(0,"m_szBPM",20));d.push(new Array(0,"m_szNoteNumber",20));d.push(new Array(0,"m_iOrderIndex",4));d.push(new Array(0,"m_ucIsOpen",1));d.push(new Array(0,"m_ucIsFree",1));d.push(new Array(0,"m_ucIsHide",1));d.push(new Array(0,"m_ucIsReward",1));d.push(new Array(0,"m_ucIsLevelReward",1));d.push(new Array(0,"m_iSongType",4));WriteDataT("PapaSongConfig_Client_Tab","PapaSongConfig_Client",d);break;case"mrock_questconfig_client":d.push(new Array(0,"m_iQuestId",4));d.push(new Array(0,"m_szQuestName",300));d.push(new Array(0,"m_szDescription",300));d.push(new Array(0,"m_iMethod",4));d.push(new Array(0,"m_iNodeType",4));d.push(new Array(0,"m_iNodeValue",4));d.push(new Array(0,"m_iNodeLimit",4));d.push(new Array(0,"m_iSongNodeID",4));d.push(new Array(0,"m_iSongNodeNoteType",4));d.push(new Array(0,"m_iRewardType",4));d.push(new Array(0,"m_iRewardID",4));d.push(new Array(0,"m_iRewardValue",4));WriteDataT("QuestConfig_Client_Tab","QuestConfig_Client",d);break;case"mrock_recharge_ios_client":case"mrock_recharge_android_client":break;case"mrock_room_client":d.push(new Array(0,"m_ushRoomID",2));d.push(new Array(0,"m_ucSongType",1));d.push(new Array(0,"m_ucTicketType",1));d.push(new Array(0,"m_iTicketNum",4));d.push(new Array(0,"m_ucRewardType",1));d.push(new Array(0,"m_iRewardNum",4));d.push(new Array(0,"m_iRewardIntergral",4));d.push(new Array(0,"m_ucIsOpen",1));d.push(new Array(0,"m_ucIsNewOpen",1));d.push(new Array(0,"m_ucIsProp",1));d.push(new Array(0,"m_iMinClientVersion",4));WriteDataT("RoomConfig_Client_Tab","RoomConfig_Client",d);break;case"mrock_share_client":break;case"mrock_song_client":case"mrock_song_client_android":case"mrock_songlevel_client":d.push(new Array(0,"m_ushSongID",2));d.push(new Array(0,"m_iVersion",4));d.push(new Array(0,"m_szSongName",64));d.push(new Array(0,"m_szPath",64));d.push(new Array(0,"m_szArtist",64));d.push(new Array(0,"m_szComposer",64));d.push(new Array(0,"m_szSongTime",64));d.push(new Array(0,"m_iGameTime",4));d.push(new Array(0,"m_iRegion",4));d.push(new Array(0,"m_iStyle",4));d.push(new Array(0,"m_ucIsNew",2));d.push(new Array(0,"m_ucIsHot",2));d.push(new Array(0,"m_ucIsRecommend",2));d.push(new Array(0,"m_szBPM",64));d.push(new Array(0,"m_ucIsOpen",2));d.push(new Array(0,"m_ucCanBuy",1));d.push(new Array(0,"m_iOrderIndex",4));d.push(new Array(0,"m_bIsFree",1));d.push(new Array(0,"m_bSongPkg",1));d.push(new Array(0,"m_szFreeBeginTime",64));d.push(new Array(0,"m_szFreeEndTime",64));d.push(new Array(0,"m_ush4KeyEasy",2));d.push(new Array(0,"m_ush4KeyNormal",2));d.push(new Array(0,"m_ush4KeyHard",2));d.push(new Array(0,"m_ush5KeyEasy",2));d.push(new Array(0,"m_ush5KeyNormal",2));d.push(new Array(0,"m_ush5KeyHard",2));d.push(new Array(0,"m_ush6KeyEasy",2));d.push(new Array(0,"m_ush6KeyNormal",2));d.push(new Array(0,"m_ush6KeyHard",2));d.push(new Array(0,"m_iPrice",4));d.push(new Array(0,"m_szNoteNumber",128));d.push(new Array(0,"m_szProductID",128));d.push(new Array(0,"m_iVipFlag",4));d.push(new Array(0,"m_bIsHide",1));d.push(new Array(0,"m_bIsReward",1));d.push(new Array(0,"m_bIsLevelReward",1));WriteDataT("SongConfig_Client_Tab","SongConfig_Client",d);break;case"mrock_SongPkg_client":d.push(new Array(0,"m_ushIndex",2));d.push(new Array(0,"m_szProductID",128));d.push(new Array(0,"m_szDesc",512));d.push(new Array(0,"m_szPath",128));d.push(new Array(0,"m_iAndroidPrice",4));d.push(new Array(0,"m_iPrice",4));d.push(new Array(0,"m_iEnable",4));d.push(new Array(0,"m_bIsNew",1));d.push(new Array(0,"m_bIsHot",1));d.push(new Array(0,"m_iNum",4));d.push(new Array(1,"m_astSongs,PkgSong",10));WriteDataT("SongPkgConfig_Client_Tab","SongPkgConfig_Client",d);break;case"mrock_starmall_exchange_client":break;case"mrock_SysParam_client":d.push(new Array(0,"m_iParamID",4));d.push(new Array(0,"m_iParamValue",4));WriteDataT("SysParamConfig_Client_Tab","SysParamConfig_Client",d);break;case"mrock_txt_client":d.push(new Array(0,"m_uiID",4));d.push(new Array(0,"m_szDescriptionZH",256));WriteDataT("TxtConfig_Client_Tab","TxtConfig_Client",d);break;}
return new Uint8Array(bin);}
function ImdToTxt(b){if(b.length==0){return"";}
var p=0;var Beat=0;var Action=0;var txt=new Array();txt.push(BytesToHex(SliceBytes(b,p,p+4)," "));p+=4;Beat=BytesToInt32(SliceBytes(b,p,p+4));txt.push(BytesToHex(SliceBytes(b,p,p+4)," "));p+=4;for(var i=0;i<Beat;i++){txt.push(BytesToHex(SliceBytes(b,p,p+12)," "));p+=12;}
txt.push(BytesToHex(SliceBytes(b,p,p+2)," "));p+=2;Action=BytesToInt32(SliceBytes(b,p,p+4));txt.push(BytesToHex(SliceBytes(b,p,p+4)," "));p+=4;for(var i=0;i<Action;i++){txt.push(BytesToHex(SliceBytes(b,p,p+11)," "));p+=11;}
return txt.join("\r\n");}
function ImdToSrc(b,o){if(b.length==0){return"";}
var p=0;var Time=0;var BPM=0;var Beat=0;var Action=0;var Combo=0;var Key=4;var Beats=new Array();var BPMs=new Array();var Actions=new Array();var Timestamps=new Array();var Tracks=new Array();var Timespans=new Array();var BeatLines=new Array();var DeterminePoints=new Array();var DetermineLines=new Array();var ComboTimestamps=new Array();var ComboTracks=new Array();Time=BytesToInt32(SliceBytes(b,p,p+4));p+=4;Beat=BytesToInt32(SliceBytes(b,p,p+4));p+=4;for(var i=0;i<Beat;i++){Beats.push(BytesToInt32(SliceBytes(b,p,p+4)));p+=4;BPMs.push(BytesToFloat64(SliceBytes(b,p,p+8)));p+=8;}
BPM=MajorityArray(BPMs);p+=2;Action=BytesToInt32(SliceBytes(b,p,p+4));p+=4;for(var i=0;i<Action;i++){Actions.push(BytesToInt32(SliceBytes(b,p,p+2)));Timestamps.push(BytesToInt32(SliceBytes(b,p+2,p+6)));Tracks.push(BytesToInt32(SliceBytes(b,p+6,p+7)));Timespans.push(BytesToInt32(SliceBytes(b,p+7,p+11)));p+=11;}
for(var i=0;i<Actions.length;i++){if(Key!=5){if((Actions[i]!=0)&&((Tracks[i]==4)||(Tracks[i]+Timespans[i]==4))){Key=5;}}
if((Tracks[i]==5)||(Tracks[i]+Timespans[i]==5)){Key=6;break;}}
for(var i=0;i<Beats.length;i++){if(i<Beats.length-1){var n=(Beats[i+1]-Beats[i])/4;BeatLines.push(Beats[i]);BeatLines.push(Math.floor(Beats[i]+n));BeatLines.push(Math.floor(Beats[i]+n*2));BeatLines.push(Math.floor(Beats[i]+n*3));}
else{BeatLines.push(Beats[i]);}}
for(var i=0;i<Key;i++){DeterminePoints[i]=new Array();}
for(var i=0;i<Actions.length;i++){switch(Actions[i]){case 0:DeterminePoints[Tracks[i]].push(Timestamps[i]);break;case 1:case 161:DeterminePoints[Tracks[i]+Timespans[i]].push(Timestamps[i]);break;case 2:case 98:case 34:case 162:var dt;var dn;var di;var dr;var dp;dt=Timestamps[i];do{DeterminePoints[Tracks[i]].push(Math.round(dt));dn=Math.floor(dt*BPM/60000);while(Beats[dn]>dt){dn-=1;}
while(Beats[dn+1]<dt){dn+=1;}
di=(Beats[dn+1]-Beats[dn])/4;dr=Beats[dn+1]-dt;if(dr==0){dn+=1;di=(Beats[dn+1]-Beats[dn])/4;dr=Beats[dn]-dt;}
if(dr>=di){dt+=di;}
else{dt+=dr;dp=1-dr/di;dn+=1;di=(Beats[dn+1]-Beats[dn])/4;dt+=di*dp;}
dt=CloseNumber(dt,Beats[dn],3);dt=CloseNumber(dt,Timestamps[i]+Timespans[i],3);}
while(dt<=Timestamps[i]+Timespans[i]);break;}}
for(var i=0;i<Key;i++){for(var j=0;j<DeterminePoints[i].length;j++){DetermineLines.push(DeterminePoints[i][j]);}}
DetermineLines=UnrepeatArray(DetermineLines).sort(SortNumber);for(var i=0;i<DetermineLines.length;i++){for(var j=0;j<Key;j++){if(DeterminePoints[j].indexOf(DetermineLines[i])!=-1){ComboTimestamps.push(DetermineLines[i]);ComboTracks.push(j);}}}
Combo=ComboTimestamps.length;var PaddingTop=88;var PaddingBottom=64;var PaddingLeft=64;var PaddingRight=64;var SpeedRate=Math.ceil(Time/(32767-PaddingTop-PaddingBottom));var CoreWidth=128;var CoreHeight=Time/SpeedRate;var WholeWidth=PaddingLeft+CoreWidth+PaddingRight;var WholeHeight=PaddingTop+CoreHeight+PaddingBottom;var NoteWidth=Math.round(CoreWidth/Key*(105-5*Key)/100);var NoteHeight=CoreWidth/16;var TouchNoteStyle="#0000FF";var HoldNoteStyle="#00FF00";var StrokeWidth=CoreWidth/32;var StrokeStyle="#00FF00";var ArrowStyle="#00FF00";var BackgroundStyle="#FFFFFF";var FrameStokeWidth=1;var FrameStokeStyle="#000000";var TrackLineWidth=0.24;var TrackLineStyle="#00FFFF";var BeatLineWidth=0.24;var BeatLineStyle="#000000";var DetermineLineWidth=0.24;var DetermineLineStyle="#FF0000";var DeterminePointRadius=NoteHeight/2;var DeterminePointStyle="#FF00FF";var TextStyle="#000000";var TextFont="12px Arial";var BoldTextFont="14px 宋体 bold";var cvs=document.createElement("canvas");cvs.style.display="none";cvs.width=WholeWidth;cvs.height=WholeHeight;var ctx=cvs.getContext("2d");var DrawLine=function(x1,y1,x2,y2,w,s){ctx.beginPath();ctx.moveTo(Math.floor(x1),Math.floor(y1));ctx.lineTo(Math.floor(x2),Math.floor(y2));ctx.lineWidth=w;ctx.strokeStyle=s;ctx.stroke();}
var DrawPoint=function(x,y,r,s){ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);s=ctx.createRadialGradient(x,y,r/8,x,y,r);s.addColorStop(0,"#FFCCCC");s.addColorStop(0.5,"#FF6666");s.addColorStop(1,"#FF0000");ctx.fillStyle=s;ctx.fill();}
var DrawText=function(x,y,t,s,f,a){ctx.fillStyle=s;ctx.font=f;ctx.textAlign=a;ctx.fillText(t,x,y);}
var DrawNote=function(a,x,y){switch(a){case 0:ctx.fillStyle=TouchNoteStyle;break;default:ctx.fillStyle=HoldNoteStyle;break;}
ctx.fillRect(Math.round(x-NoteWidth/2),Math.round(y-NoteHeight/2),NoteWidth,NoteHeight);}
var DrawStroke=function(x1,y1,x2,y2){DrawLine(Math.round(x1),Math.round(y1),Math.round(x2),Math.round(y2),StrokeWidth,StrokeStyle);}
var DrawArrow=function(t,x,y){ctx.beginPath();if(t<0){ctx.moveTo(Math.round(x+StrokeWidth/2),Math.round(y+StrokeWidth));ctx.lineTo(Math.round(x+StrokeWidth/2),Math.round(y-StrokeWidth));ctx.lineTo(Math.round(x+StrokeWidth/2-StrokeWidth*2),Math.round(y));}
else if(t>0){ctx.moveTo(Math.round(x-StrokeWidth/2),Math.round(y+StrokeWidth));ctx.lineTo(Math.round(x-StrokeWidth/2),Math.round(y-StrokeWidth));ctx.lineTo(Math.round(x-StrokeWidth/2+StrokeWidth*2),Math.round(y));}
ctx.closePath();ctx.lineWidth=1;ctx.fillStyle=ArrowStyle;ctx.fill();}
var DrawKey=function(Action,Timestamp,Track,Timespan){switch(Action){case 0x00:DrawNote(Action,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);break;case 0x01:DrawNote(Action,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);if(Timespan<0){DrawStroke(CoreWidth/Key*(Track+0.5+Timespan)+StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5)-NoteWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);DrawArrow(Timespan,CoreWidth/Key*(Track+0.5+Timespan)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
else if(Timespan>0){DrawStroke(CoreWidth/Key*(Track+0.5)+NoteWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5+Timespan)-StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);DrawArrow(Timespan,CoreWidth/Key*(Track+0.5+Timespan)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
break;case 0x02:DrawNote(Action,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);DrawStroke(CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-NoteHeight/2-PaddingBottom,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate+StrokeWidth/2-PaddingBottom);DrawStroke(CoreWidth/Key*(Track+0.5)-StrokeWidth+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5)+StrokeWidth+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate-PaddingBottom);break;case 0x61:DrawNote(Action,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);if(Timespan<0){DrawStroke(CoreWidth/Key*(Track+0.5+Timespan)-StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5)-NoteWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
else if(Timespan>0){DrawStroke(CoreWidth/Key*(Track+0.5)+NoteWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5+Timespan)+StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
break;case 0x62:DrawNote(Action,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);DrawStroke(CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-NoteHeight/2-PaddingBottom,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate+StrokeWidth/2-PaddingBottom);break;case 0x21:if(Timespan<0){DrawStroke(CoreWidth/Key*(Track+0.5+Timespan)-StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5)+StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
else if(Timespan>0){DrawStroke(CoreWidth/Key*(Track+0.5)-StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5+Timespan)+StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
break;case 0x22:DrawStroke(CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-StrokeWidth/2-PaddingBottom,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate+StrokeWidth/2-PaddingBottom);break;case 0xA1:if(Timespan<0){DrawStroke(CoreWidth/Key*(Track+0.5+Timespan)+StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5)+StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);DrawArrow(Timespan,CoreWidth/Key*(Track+0.5+Timespan)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
else if(Timespan>0){DrawStroke(CoreWidth/Key*(Track+0.5)-StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5+Timespan)-StrokeWidth/2+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);DrawArrow(Timespan,CoreWidth/Key*(Track+0.5+Timespan)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-PaddingBottom);}
break;case 0xA2:DrawStroke(CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-StrokeWidth/2-PaddingBottom,CoreWidth/Key*(Track+0.5)+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate+StrokeWidth/2-PaddingBottom);DrawStroke(CoreWidth/Key*(Track+0.5)-StrokeWidth+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate-PaddingBottom,CoreWidth/Key*(Track+0.5)+StrokeWidth+PaddingLeft,WholeHeight-Timestamp/SpeedRate-Timespan/SpeedRate-PaddingBottom);break;}}
if(o[0]){ctx.fillStyle=BackgroundStyle;ctx.fillRect(0,0,cvs.width,cvs.height);}
ctx.globalAlpha=0.618;if(o[1]){for(var i=0;i<Key+1;i++){DrawLine(CoreWidth/Key*i+PaddingLeft,WholeHeight-PaddingBottom,CoreWidth/Key*i+PaddingLeft,PaddingTop,TrackLineWidth,TrackLineStyle);}}
if(o[2]){ctx.lineWidth=FrameStokeWidth;ctx.strokeStyle=FrameStokeStyle;ctx.strokeRect(0,0,cvs.width,cvs.height);}
if(o[3]){for(var i=0;i<BeatLines.length;i++){DrawLine(0,WholeHeight-BeatLines[i]/SpeedRate-BeatLineWidth/2-PaddingBottom,WholeWidth,WholeHeight-BeatLines[i]/SpeedRate-BeatLineWidth/2-PaddingBottom,BeatLineWidth,BeatLineStyle);DrawText(0,WholeHeight-BeatLines[i]/SpeedRate-BeatLineWidth/2-PaddingBottom,Math.round(BeatLines[i]).toString(),BeatLineStyle,TextFont,"left");}}
for(var i=0;i<Actions.length;i++){DrawKey(Actions[i],Timestamps[i],Tracks[i],Timespans[i])}
if(o[5]){for(var i=0;i<DetermineLines.length;i++){DrawLine(0,WholeHeight-DetermineLines[i]/SpeedRate-DetermineLineWidth/2-PaddingBottom,WholeWidth,WholeHeight-DetermineLines[i]/SpeedRate-DetermineLineWidth/2-PaddingBottom,DetermineLineWidth,DetermineLineStyle);DrawText(WholeWidth,WholeHeight-DetermineLines[i]/SpeedRate-DetermineLineWidth/2-PaddingBottom,Math.round(DetermineLines[i]).toString(),DetermineLineStyle,TextFont,"right");}}
if(o[4]){for(var i=0;i<ComboTimestamps.length;i++){DrawPoint(CoreWidth/Key*(ComboTracks[i]+0.5)+PaddingLeft,WholeHeight-ComboTimestamps[i]/SpeedRate-PaddingBottom,DeterminePointRadius,DeterminePointStyle);DrawText(CoreWidth/Key*(ComboTracks[i]+0.5)+PaddingLeft,WholeHeight-ComboTimestamps[i]/SpeedRate-PaddingBottom-NoteHeight/2,(i+1).toString(),DeterminePointStyle,TextFont,"center");}}
DrawText(WholeWidth/2,18,FileName+".bin",TextStyle,BoldTextFont,"center");DrawText(0+PaddingLeft/1.3,38,"时间："+MillisecondToTime(Time).toString(),TextStyle,TextFont,"left");DrawText(WholeWidth-CoreWidth/2-PaddingRight/1.3,38,"拍速："+BPM.toString(),TextStyle,TextFont,"left");DrawText(0+PaddingLeft/1.3,56,"节拍："+Beat.toString(),TextStyle,TextFont,"left");DrawText(WholeWidth-CoreWidth/2-PaddingRight/1.3,56,"动作："+Action.toString(),TextStyle,TextFont,"left");DrawText(0+PaddingLeft/1.3,74,"音符："+Combo.toString(),TextStyle,TextFont,"left");DrawText(WholeWidth-CoreWidth/2-PaddingRight/1.3,74,"键位："+Key.toString(),TextStyle,TextFont,"left");DrawText(WholeWidth/2,WholeHeight-48,"Draw by rmstZ.html",TextStyle,TextFont,"center");DrawText(WholeWidth/2,WholeHeight-30,"in "+GetDateTime(),TextStyle,TextFont,"center");DrawText(WholeWidth/2,WholeHeight-10,"Copyright © 心のsky Group",TextStyle,BoldTextFont,"center");return cvs.toDataURL("image/png");}
function MdeToXml(b){if(b.length==0){return"";}
return BytesToText(RTrimBytes(Base64ToBytes(BytesToText(b)),0));}
function Mp3ToImd(b){if(b.length==0){return"";}
window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;var ctx=new AudioContext();var visualize=function(ctx,bf){var bs=ctx.createBufferSource();var as=ctx.createAnalyser();bs.connect(as);as.connect(ctx.destination);bs.buffer=bf;if(!bs.start){bs.start=bs.noteOn
bs.stop=bs.noteOff};bs.start(0);this.status=1;this.source=bs;var fd=new Uint8Array(as.frequencyBinCount);as.getByteFrequencyData(fd);var td=new Uint8Array(as.fftSize);as.getByteTimeDomainData(td);return;}
ctx.decodeAudioData(b.buffer,function(bf){visualize(ctx,bf);},function(e){alert(e.toString());});}</script><script type="text/javascript">function HideControl(){document.getElementById("divOperateImd").style.display="none";document.getElementById("divSave").style.display="none";document.getElementById("divResult").innerHTML="";}
function ShowHtml(d,e,t){if(!IsUCBrowser&&(d.length!=0)){var a=document.getElementById("aSave");a.href=URL.createObjectURL(new Blob([TextToBytes(d)],{"type":t}));a.download=GetFileName(FileName)+"."+e;if(a.href!=""){document.getElementById("divSave").style.display="block";}}
if((GetExtension(FileName)=="bin")&&(d=="")){d="该模式暂不支持。缺少原材料啊 = =!";}
var p=document.createElement("p");p.style.textAlign="left";p.style.fontSize="14px";p.innerHTML=TextToHtml(d).replace(/\r\n/g,"<br/>");document.getElementById("divResult").appendChild(p);}
function ShowBin(s,d,e,t){if(!IsUCBrowser&&(d.length!=0)){var a=document.getElementById("aSave");a.href=URL.createObjectURL(new Blob([d],{"type":t}));a.download=GetFileName(FileName)+"."+e;if(a.href!=""){document.getElementById("divSave").style.display="block";}}
var p=document.createElement("p");p.style.textAlign="left";p.style.fontSize="14px";p.innerHTML=TextToHtml(s).replace(/\r\n/g,"<br/>");document.getElementById("divResult").appendChild(p);}
function ShowImg(d,e,t){if(!IsUCBrowser&&(d.length!=0)){var a=document.getElementById("aSave");a.href=URL.createObjectURL(new Blob([Base64ToBytes(d.split(",")[1])],{"type":t}));a.download=GetFileName(FileName)+"."+e;if(a.href!=""){document.getElementById("divSave").style.display="block";}}
var img=document.createElement("img");img.src=d;document.getElementById("divResult").appendChild(img);}
function ShowAudio(d,e){return;}
function ReadBuffer(){HideControl();switch(GetExtension(FileName)){case"bin":ShowHtml(BinToXml(FileBuffer),"xml","text/html");break;case"xml":ShowBin(TxtToTxt(FileBuffer),XmlToBin(FileBuffer),"bin","application/octet-binary");break;case"imd":document.getElementById("divOperateImd").style.display="block";var s=document.getElementById("selectModeImd");switch(s.options[s.selectedIndex].value){case"txt":ShowHtml(ImdToTxt(FileBuffer),"txt","text/plain");break;case"png":if(!SupportCanvasAPI){alert("当前浏览器内核不支持Canvas API。");return;}
ShowImg(ImdToSrc(FileBuffer,new Array(document.getElementById("inputDrawBackground").checked,document.getElementById("inputDrawTrack").checked,document.getElementById("inputDrawFrame").checked,document.getElementById("inputDrawBeat").checked,document.getElementById("inputDrawCombo").checked,document.getElementById("inputDrawDetermine").checked)),"png","image/png");break;}
break;case"mde":ShowHtml(MdeToXml(FileBuffer),"xml","text/html");break;case"mp3":if(!SupportCanvasAPI){alert("当前浏览器内核不支持Canvas API。");return;}
if(!SupportAudioAPI){alert("当前浏览器内核不支持Audio API。");return;}
ShowAudio(Mp3ToImd(FileBuffer),"imd");break;default:ShowHtml(TxtToTxt(FileBuffer),GetExtension(FileName),"text/plain");}}
function ReadFile(e){if(!SupportFileAPI){alert("当前浏览器内核不支持File API。");return;}
var r=new FileReader();r.onload=function(){FileBuffer=new Uint8Array(this.result);ReadBuffer();}
FileName=e.target.files[0].name;r.readAsArrayBuffer(e.target.files[0]);}
function SelectChanged(){switch(GetExtension(FileName)){case"imd":var s=document.getElementById("selectModeImd");switch(s.options[s.selectedIndex].value){case"png":document.getElementById("divOptionImd").style.display="block";document.getElementById("divOptionImd2").style.display="block";break;default:document.getElementById("divOptionImd").style.display="none";document.getElementById("divOptionImd2").style.display="none";}
break;}
ReadBuffer();}
function CheckChanged(){ReadBuffer();}
var FileName;var FileBuffer;</script></body></html>